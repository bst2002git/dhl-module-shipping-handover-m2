resource_types:
- name: lftp-resource
  type: docker-image
  source:
      repository: machinerytool/concourse-lftp-resource
      tag: latest

resources:
- name: git-module-shipping-handover-m2
  type: git
  source:
    uri: https://git.netresearch.de/dhl/module-shipping-handover-m2
    username: ((GITLAB_NETRESEARCH_USER))
    password: ((GITLAB_NETRESEARCH_USER_TOKEN))
    branch: DHLVM2-169
- name: test-sftp
  type: lftp-resource
  source:
    url: sftp://max.melzer:dafsdc@magneto.nr
    regexp: kernel-default-(.*).x86_64.rpm

- name: samba-resource
  type: samba-resource
  source:
    server: NAS
    share: storage
    user : user
    password: {{ samba_password_from_env }}

jobs:
- name: build
  plan:

  - get: git-module-shipping-handover-m2
    trigger: true

  - task: build-documentation
    config:
      platform: linux
      image_resource:
        type: docker-image
        source: {repository: maxmelzer/docker-python-docutils}
      inputs:
      - name: git-module-shipping-handover-m2
      run:
        path: build/concourse/build.sh
        dir: git-module-shipping-handover-m2
      outputs:
      - name: new-git
        path: new-git

  - put: git-module-shipping-handover-m2
    params: {repository: git-module-shipping-handover-m2}
